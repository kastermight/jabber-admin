
_ExcelBookSaveAs

Сохраняет рабочую книгу Excel под новым именем/расположением или типом (инициализация "Сохранить как") 
Внимание!!! пересохранение книги без изменения каких либо параметров необходимо выполнять при помощи _ExcelBookSave
использование этой функции в таком случае вызовет ошибку. 

#Include 
_ExcelBookSaveAs($oExcel, $sFilePath [, $sType = "xls" [, $fAlerts = 0 [, $fOverWrite = 0 [, $sPassword = "" [, $sWritePassword = "" [, $iAccessMode = 1 [, $iConflictResolution = 2]]]]]]])

---  Таблица параметров  ---
$oExcel
	Ссылка на COM-объект "Excel.Application" полученная ранее вызванными  _ExcelBookOpen(),  _ExcelBookNew(), или _ExcelBookAttach()
$sFilePath
	Путь + имя сохраняемого файла (н/п C:\Docunents\myworkbook)
	Внимание!!! имя указывается без расширения, расширение сохраняемого файла определяется параметром $sType
$sType
	[опционально] Формат сохраняемого файла предусмотренный версией Excel = "xls|csv|txt|template|html", по умолчанию "xls"	
	Внимание!!! см.Примечание 
$fAlerts
	[опционально] Флаг определяющий наличие оповещений/запросов Excel (0=отключены, 1=включены) (по умолчанию = 0)
$fOverWrite
	[опционально] Флаг определяющий состояние перезаписи, если указанный файл уже существует (0=не перезаписывать,1=перезаписывать)
$sPassword
	[опционально] Пароль к защищенной паролем книге Excel  (по умолчанию = "")
$sWritePassword
	[опционально] Пароль защиты от редактирования в рабочей книге (по умолчанию="")
$iAccessMode
	[опционально] Признак совместного использования у рабочей книги (sharing),
	для определения этого параметра используются следующие константы:
	$xlNoChange - Принять значение исходного файла (по умолчанию) 
	(числовой эквивалент = 1)
	$xlExclusive - Отключает признак совместного использования у рабочей книги 
	(числовой эквивалент = 3)
	$xlShared - Включает признак совместного использования у рабочей книги 
	(числовой эквивалент = 2)
$iConflictResolution
	[опционально] Для документов с признаком совместного использования, определяет как разрешать конфликты совместного использования,
	для определения этого параметра используются следующие константы:
	$xlUserResolution - Вызывать диалоговое окно для выбора условий разрешения конфликта пользователем (числовое значение = 1)
	$xlLocalSessionChanges - Изменения локального пользователя(владельца) всегда принимаются (по умолчанию) (числовое значение = 2)
	$xlOtherSessionChanges - Изменения локального пользователя(владельца) всегда отклоняются (числовое значение = 3)

---  Таблица возвращаемых значений  ---
Успех:	1
Ошибка:	Возвращает 0, Устанавливает значение флага ошибки @ERROR:
@error:	0 - Скрипт завершил работу без ошибок
	1 - Ошибка OLE/COM ($oExcel), возможно указанный объект не существует
	2 - Не верно указан тип файла ($sType)
	3 - Файл открыт только для чтения

---  Примечания  ---
В MS Office 2007-2010 доступен более расширенный список форматов "xlsx|xlsb|xlsm и т.д.", 
"по умолчанию" используется формат "xlsx" 
В базовой UDF "Excel.au3" использование в этой функции таких форматов не предусмотрено, 
это можно исправить модифицированием "Excel.au3";
Инструкции и внедряемый код переведены на этой странице (см.Пример 3)

---  Смотрите также  ---
_ExcelBookSave