
_ExcelReadSheetToArray

Возвращает двумерный массив заполненный данными из указанного количества строк и столбцов активного листа открытой рабочей книги Excel 

#Include 
_ExcelReadSheetToArray($oExcel [, $iStartRow = 1 [, $iStartColumn = 1 [, $iRowCnt = 0 [, $iColCnt = 0 [, $iColShift = False]]]]])

---  Таблица параметров  ---
$oExcel
	Ссылка на COM-объект "Excel.Application" полученная ранее вызванными  _ExcelBookOpen(),  _ExcelBookNew(), или _ExcelBookAttach()
$iStartRow
	[опционально] Целевая строка, с которой начнется выборка данных в массив (по умолчанию = 1)
$iStartColumn
	[опционально] Целевой столбец, с которого начнется выборка данных в массив (по умолчанию = 1)
$iRowCnt
	[опционально] Количество вбираемых в возвращаемый массив строк вниз относительно целевой строки (по умолчанию = 0(все))
$iColCnt
	[опционально] Количество вбираемых в возвращаемый массив столбцов вправо относительно целевой строки (по умолчанию = 0(все))
$iColShift
	[опционально] Флаг, определяющий нижнюю границу индексов создаваемого массива (Option Base) (True = 0, False = 1) (по умолчанию = False)

---  Таблица возвращаемых значений  ---
Успех:	Возвращает двухмерный массив заполненный данными из указанного количества строк и столбцов активного листа открытой рабочей книги Excel
Ошибка:	Возвращает 0, Устанавливает значение флага ошибки @ERROR:
@error:	0 - Скрипт завершил работу без ошибок
	1 - Ошибка OLE/COM ($oExcel), возможно указанный объект не существует
	2 - Недопустимое значение параметра(ов) определяющих целевую строку/столбец ($iStartRow, $iStartColumn)
	3 - Недопустимое значение параметра(ов) определяющих количество вбираемых в массив строк/столбцов ($iColCnt, $iRowCnt)
@extended:	0 - Ошибка в значении строки
	1 - Ошибка в значении столбца

---  Примечания  ---
Для того чтобы индексы возвращаемого двухмерного массива соответствовали формату адресов ячеек R1C1(номер строки/номер столбца),
"Option Base"($iColShift) возвращаемого массива должен быть определен = False (по умолчанию).
----------------------------------------------------------------------------------------
Внимание!!! документы разных форматов MS Office имеют различные ограничения по количеству столбцов и строк:
*.xls (формат xlExcel8, стандартный для MS Office 2003,97,95) имеет ограничения в 255 столбцов 65 535 строк
*.xlsx,*.xlsb,*.xlsm (XML-форматы MS Office 2007-2010) имеют ограничения в 16 384 столбца и 1 048 576 строк

---  Смотрите также  ---